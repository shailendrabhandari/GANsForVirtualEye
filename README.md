
# Overview

This project focuses on analyzing real and generated eye-tracking velocity data using various models, including **GAN (Generative Adversarial Network)** and z*Hidden Markov Models (HMMs)** with 2 and 3 hidden states. The project aims to compare real velocity data with synthetic data generated by these models through different metrics, including histograms, JS divergence, and autocorrelation plots.

### Models Used
1. **GAN**: 
   - A generative model to synthesize eye-tracking velocity data.
   - Two versions were trained:
     - **GAN (Standard)**.
     - **GAN with Spectral Loss**.

2. **Hidden Markov Models (HMM)**:
   - **HMM with 2 Hidden States**.
   - **HMM with 3 Hidden States**.
   - Both models were trained on eye-tracking velocity data to generate synthetic samples.

### Data Used
- The **velocity_left** data from an eye-tracking dataset was used as the real data input for all models.
  
---

## Steps Performed

### 1. Data Loading and Preprocessing
   - **Loading Data**: Eye-tracking velocity data (`velocity_left`) was loaded and preprocessed for model input.
   - **Preprocessing**: This included handling NaN values and normalizing the data before feeding it into the models.

### 2. Training Models

#### GANs Models:
- **Model Definition**: AGAN generator and discriminator were defined and trained on normalized velocity data.
- **Training**: The models were trained using the standard GAN training loop.
  - **Standard GAN**: Regular GAN training.
  - **GAN with Spectral Loss**: Included additional spectral loss in the training objective.
  
#### HMM Models:
- **HMM with 2 Hidden States**: A Gaussian HMM was trained using the `velocity_left` data with 2 hidden states.
- **HMM with 3 Hidden States**: Another HMM was trained with 3 hidden states.
  
### 3. Visualization and Metrics

#### Histograms and JS Divergence:
- Histograms were plotted to compare the **log-transformed real velocity data** with the **generated data from HMM models**.
- **JS Divergence** was calculated to quantify the similarity between the real data and generated data from the models.

#### Autocorrelation Analysis:
- Autocorrelation plots were generated to assess the correlation of the velocity data at different time lags. These plots compared real data, data generated by the DCGAN models, and data generated by HMMs (2 and 3 hidden states).

---

## Instructions for Execution

### Prerequisites
1. **Python 3.x**.
2. **PyTorch**: Used for implementing DCGAN.
3. **hmmlearn**: Used for Hidden Markov Model training.
4. **Numpy, Matplotlib, Scipy**: For data processing, plotting, and divergence calculations.

### Project Structure
```
/GAN_model
│
├── data_loading.py       # Contains data loading and preprocessing functions.
├── model_definitions.py  # Contains the DCGAN model definitions with/without fourier loss.
├── training.py           # Contains the GAN training loop.
├── hiddenMarkov.py       # Contains functions to train HMM with 2 and 3 hidden states.
├── visualization.py      # Script for visualization (histograms, autocorrelation).
├── running.py            # Main script to load data, train models, and visualize results.
├── results/              # Folder where results (plots, saved models) are stored.
└── README.txt            # Project summary and instructions.
```

### How to Run

1. **Step 1: Preprocess and Load Data**
   - Modify `running.py` to ensure the correct path to your eye-tracking dataset. The dataset should have the `velocity_left` data ready.
   
2. **Step 2: Train Models**
   - Run `running.py` to load data, train the **GAN** models and **HMM** models, and generate the synthetic data:
     ```bash
     python3 running.py
     ```

3. **Step 3: Visualize Results**
   - To visualize the generated data (histograms, autocorrelation plots):
     ```bash
     python3 visualization.py
     ```

4. **Results**:
   - **Histograms** comparing real vs generated data are saved in the `results/` folder.
   - **Autocorrelation plots** are saved in the `results/` folder.
   - Trained DCGAN and HMM models are saved in `results/` for reuse.

---

## Results Folder
All visualizations (histograms, JS divergence, and autocorrelation plots) are saved in the `results/` directory.

- **Autocorrelation Plots**: Compare real data with generated data from GAN and HMM models.
  - `Autocorrelation_Real_vs_Generated.pdf`
  
- **Histograms**: Compare real data and generated data using HMMs and GAN.
  - `RealVSGenerated_HMM_2HS.pdf` (HMM with 2 hidden states)
  - `RealVSGenerated_HMM_3HS.pdf` (HMM with 3 hidden states)

- **Saved Models**: Trained models for later use.
  - `G_SD_model_1.pt`: Generator for GAN.
  - `G_SD_model_2.pt`: Generator for GAN with spectral loss.
  - `D_SD_model_1.pt`: Discriminator for GAN.

---

## Future Work
1. Experiment with more advanced GAN architectures.
2. Incorporate different loss functions in training HMM models.
3. Evaluate the models with more advanced metrics (e.g., FID score).

